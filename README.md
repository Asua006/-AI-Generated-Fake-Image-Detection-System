# (AI-Generated)Fake Image Detection System

A complete end-to-end deep learning system to detect AI-generated (fake) images using transfer learning with EfficientNetB0.

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-red.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

---

## Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Project Structure](#project-structure)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Usage](#usage)
- [Model Architecture](#model-architecture)
- [Results](#results)
- [Web Application](#web-application)
- [Troubleshooting](#troubleshooting)
- [Future Improvements](#future-improvements)
- [License](#license)

---

## Overview

This project implements a binary classifier that distinguishes between:
- **Real images**: Captured by cameras
- **Fake images**: Generated by AI (GANs, Diffusion models, DALL-E, Midjourney, Stable Diffusion)

The system uses **transfer learning** with EfficientNetB0 pre-trained on ImageNet for efficient training and high accuracy.

### Why This Matters

With the rise of AI image generators, it's becoming increasingly difficult to distinguish real photographs from AI-generated images. This system helps detect AI-generated content by analyzing:
- Visual artifacts and inconsistencies
- Frequency domain patterns
- Texture irregularities
- Generation-specific fingerprints

---

##  Features

-  **Transfer Learning**: EfficientNetB0 with ImageNet weights
-  **Two-Phase Training**: Classifier-only → Full fine-tuning
-  **High Accuracy**: 90-95% test accuracy
-  **Fast Training**: 30-60 min on GPU, 3-5 hours on CPU
-  **Web Interface**: Streamlit app for easy testing
-  **Comprehensive Evaluation**: Confusion matrix, ROC curve, metrics
-  **Single Image Prediction**: Command-line tool
-  **Production Ready**: Clean, modular, well-documented code

---

## Project Structure

```
fake-image-detector/
│
├── README.md                    # This file
├── requirements.txt             # Python dependencies
├── config.py                    # Configuration settings
│
├── data/
│   ├── raw/                     # Raw dataset
│   │   ├── real/
│   │   └── fake/
│   └── processed/               # Train/val/test split
│       ├── train/
│       ├── val/
│       └── test/
│
├── src/
│   ├── __init__.py
│   ├── dataset.py               # Data loading and preprocessing
│   ├── model.py                 # Model architecture
│   ├── train.py                 # Training script
│   ├── evaluate.py              # Evaluation script
│   └── predict.py               # Single image prediction
│
├── app/
│   └── app.py                   # Streamlit web application
│
└── outputs/
    ├── models/                  # Saved models
    ├── plots/                   # Visualizations
    └── logs/                    # Training logs
```

---

## Installation

### Prerequisites

- Python 3.8 or higher
- pip package manager
- (Optional) CUDA-capable GPU for faster training

### Step 1: Clone Repository

```bash
git clone https://github.com/yourusername/fake-image-detector.git
cd fake-image-detector
```

### Step 2: Create Virtual Environment

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Mac/Linux
python3 -m venv venv
source venv/bin/activate
```

### Step 3: Install Dependencies

```bash
pip install -r requirements.txt
```

---

## Quick Start

### 1. Download Dataset

**Option A: CIFAKE Dataset (Recommended)**

```bash
# Install Kaggle CLI
pip install kaggle

# Download dataset
kaggle datasets download -d birdy654/cifake-real-and-ai-generated-synthetic-images

# Extract
unzip cifake-real-and-ai-generated-synthetic-images.zip -d data/raw/
```

**Option B: Manual Download**
- Download from [Kaggle](https://www.kaggle.com/datasets/birdy654/cifake-real-and-ai-generated-synthetic-images)
- Extract to `data/raw/` with structure: `data/raw/real/` and `data/raw/fake/`

### 2. Prepare Dataset

```bash
python src/dataset.py
```

Expected output:
```
Splitting dataset...
Train: 7000 images per class
Val: 1500 images per class
Test: 1500 images per class
✓ Dataset preparation complete!
```

### 3. Train Model

```bash
python src/train.py
```

Training time:
- **GPU**: 30-60 minutes
- **CPU**: 2-3 hours
- **Google Colab (Free GPU)**: 45 minutes

### 4. Evaluate Model

```bash
python src/evaluate.py
```

### 5. Launch Web App

```bash
streamlit run app/app.py
```

Open browser at `http://localhost:8501`

---

### Training

```bash
# Train with default settings
python src/train.py

# Training automatically:
# - Phase 1: Trains classifier (5 epochs)
# - Phase 2: Fine-tunes entire model (10 epochs)
# - Saves best model based on validation accuracy
```

### Evaluation

```bash
# Evaluate on test set
python src/evaluate.py

# Generates:
# - Classification report
# - Confusion matrix
# - ROC curve
# - Prediction distribution plots
```

### Single Image Prediction

```bash
# Basic prediction
python src/predict.py --image path/to/image.jpg

# With visualization
python src/predict.py --image path/to/image.jpg --visualize

# Save visualization
python src/predict.py --image path/to/image.jpg --save output.png
```

### Web Application

```bash
streamlit run app/app.py
```

Features:
- Drag-and-drop image upload
- Real-time prediction
- Confidence scores
- Visual feedback
- Technical details

---

### Base Model: EfficientNetB0

```
INPUT (224×224×3)
    ↓
EfficientNetB0 Backbone (Pre-trained on ImageNet)
    ↓
Global Average Pooling
    ↓
Dense(256) + ReLU + Dropout(0.5)
    ↓
Dense(1) + Sigmoid
    ↓
OUTPUT (Probability: 0=Real, 1=Fake)
```

### Training Strategy

**Phase 1: Classifier Training**
- Freeze EfficientNet base
- Train only classifier head
- Learning Rate: 1e-4
- Epochs: 5

**Phase 2: Fine-Tuning**
- Unfreeze last 30 layers
- Fine-tune entire model
- Learning Rate: 1e-5
- Epochs: 10

### Hyperparameters

```python
Batch Size: 32
Optimizer: Adam
Loss: Binary Cross-Entropy
Scheduler: ReduceLROnPlateau
Dropout: 0.5
Image Size: 224×224
```

---

## Results

Confusion Matrix:

<img width="640" height="480" alt="confusion_matrix" src="https://github.com/user-attachments/assets/664a5302-4a57-47e0-917c-352a0bd5a213" />



### Expected Performance

| Metric | Value |
|--------|-------|
| Test Accuracy | 90-95% |
| Precision | 0.92-0.95 |
| Recall | 0.90-0.94 |
| F1-Score | 0.91-0.94 |
| AUC-ROC | 0.95-0.98 |

### Sample Confusion Matrix

```
                Predicted
                Real  Fake
Actual  Real    1400   100
        Fake     80   1420
```

### Training Time

- **CPU**: 2-3 hours
- **GPU (RTX 3060)**: 30-45 minutes
- **Google Colab (Free T4)**: 45 minutes

---

## Web Application

The Streamlit web app provides an intuitive interface for testing images:

### Features

1. **Upload Interface**: Drag-and-drop image upload
2. **Real-time Prediction**: Instant classification
3. **Confidence Score**: Visual confidence meter
4. **Technical Details**: Raw scores and probabilities
5. **Model Info**: Architecture and performance details

## Troubleshooting

### Issue: CUDA Out of Memory

**Solution:**
```python
# In config.py, reduce batch size
BATCH_SIZE = 16  # or 32 or 8
```

### Issue: ModuleNotFoundError

**Solution:**
```bash
# Set PYTHONPATH
export PYTHONPATH="${PYTHONPATH}:${PWD}"  # Linux/Mac
set PYTHONPATH=%PYTHONPATH%;%CD%  # Windows
```

### Issue: Slow Training on CPU

**Solutions:**
1. Use Google Colab free GPU
2. Reduce dataset size in `config.py`:
   ```python
   # Reduce number of images
   ```
3. Use smaller batch size

### Issue: Model Not Found

**Solution:**
```bash
# Train model first
python src/train.py
```

---

## Future Improvements

- [ ] **Multi-class Detection**: Identify specific generators (DALL-E vs Midjourney)
- [ ] **Attention Visualization**: Highlight suspicious regions using Grad-CAM
- [ ] **Ensemble Methods**: Combine multiple model architectures
- [ ] **Frequency Analysis**: Add FFT-based features
- [ ] **Metadata Extraction**: Incorporate EXIF data analysis
- [ ] **Continual Learning**: Update model as new generators emerge
- [ ] **API Endpoint**: REST API for integration
- [ ] **Batch Processing**: Handle multiple images simultaneously

---

### Datasets
- [CIFAKE Dataset](https://www.kaggle.com/datasets/birdy654/cifake-real-and-ai-generated-synthetic-images)
- [DiffusionDB](https://huggingface.co/datasets/poloclub/diffusiondb)
- [COCO Dataset](https://cocodataset.org/)

### Papers
1. Wang et al. (2020) - "CNN-generated images are surprisingly easy to spot...for now"
2. Marra et al. (2019) - "Detecting GAN-generated Fake Images"
3. Tan & Le (2019) - "EfficientNet: Rethinking Model Scaling"

### Tools
- [PyTorch Documentation](https://pytorch.org/docs/)
- [Streamlit Documentation](https://docs.streamlit.io/)
- [Google Colab](https://colab.research.google.com/)

---

